(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){},108:function(e,t,n){},110:function(e,t,n){},112:function(e,t,n){},114:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(25),c=n.n(s),i=n(28),u=n(2),o=n.n(u),l=n(3),p=n(4),d=n(5),h=n(7),f=n(6),m=n(8),v=n(116),b=n(119),k=n(115),y=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,n=e.children,a=e.onClick,s=e.style;return r.a.createElement("div",{className:"header-control",onClick:function(){return a()},style:s},r.a.createElement("div",{className:"header-control__icon"},n),r.a.createElement("span",null,t))}}]),t}(a.Component),w=n(20),g=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"panel-control"},r.a.createElement(y,{text:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",style:{visibility:"hidden"}},r.a.createElement(w.b,null)),r.a.createElement(y,{text:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0441\u0435",onClick:function(){return e.props.onCleanClick()}},r.a.createElement(w.a,null)),r.a.createElement(y,{text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",style:{visibility:"hidden"}},r.a.createElement(w.c,null)))}}]),t}(a.Component),_=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"public__info__container public__info--all"},r.a.createElement(w.d,null),this.props.peopleCount),r.a.createElement("div",{className:"public__info__container"},r.a.createElement(y,{text:"\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",onClick:function(){return e.props.onStartClean()}},r.a.createElement(w.a,null))),r.a.createElement("div",{className:"public__info__container public__info--deleted"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"feather feather-user-x"},r.a.createElement("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),r.a.createElement("circle",{cx:"8.5",cy:"7",r:"4"}),r.a.createElement("line",{x1:"18",y1:"8",x2:"23",y2:"13"}),r.a.createElement("line",{x1:"23",y1:"8",x2:"18",y2:"13"})),this.props.deletedPeople))}}]),t}(a.Component),x=(n(60),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"progress-position"},r.a.createElement("span",{className:"progress-status"},this.props.status),r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"progress-bar main-progress-bar",style:{width:"".concat(this.props.progress,"%")}},r.a.createElement("span",{className:"percent"},this.props.progress,"%"))))}}]),t}(r.a.Component)),O=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("img",{className:"public__heading__img",src:this.props.url,alt:"pub img"})}}]),t}(a.Component),E=(n(62),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"public-wrapper"},r.a.createElement("div",{className:"public"},r.a.createElement("div",{className:"public__heading"},r.a.createElement(O,{url:this.props.avatar_url}),r.a.createElement("div",{className:"public__heading__name"},this.props.name)),r.a.createElement("div",{className:"public__info"},this.props.cleanData.isCleaning?r.a.createElement(x,{progress:this.props.cleanData.progress,status:this.props.cleanData.status}):r.a.createElement(_,{peopleCount:this.props.followers,deletedPeople:this.props.dogs,onStartClean:function(){return e.props.onClean(e.props.id)}}))))}}]),t}(a.Component)),j=n(14),C=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"btn btn__add",onClick:this.props.onClick},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0421\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e")}}]),t}(a.Component),T=n(19),N=n.n(T),P=n(12),I=n.n(P),S=n(15),D=window.VK,A="https://hot-dog.site/api",G=function(){return U},L=function(){return I.a.get(A+"/getPublics",M())},B=function(){return I.a.get(A+"/getCleanTasks",M())},U=new Promise(function(e,t){D.init(function(){D.api("groups.get",{filter:"moder",extended:"1",fields:"photo_100",v:"5.85"},function(t){var n=R(t.response.items);e(n)})},function(){console.log("VK API initialization failed"),t("Groups fetch failed")},"5.85")}),R=function(e){return e.map(F)},F=function(e){return{avatar_url:e.photo_100,id:e.id,name:e.name}},M=function(){return{params:{user_vk_id:window.user_id,auth_key:window.auth_key}}},W="groups/USER_GROUPS_LOAD",K="groups/USER_GROUPS_LOADED",V={Load:"groups/GROUPS_LOAD",Loaded:"groups/GROUPS_LOADED",Errors:"groups/GROUPS_ERRORS"},$={Load:"tasks/LOAD_CLEAN_TASKS",Loaded:"tasks/CLEAN_TASKS_LOADED",Errors:"tasks/CLEAN_TASKS_ERRORS"},q={groups:{data:[],loading:!0,errors:[]},hotDogsGroups:{data:[],loading:!0,errors:[]},cleanTasks:{data:[],loading:!0,errors:[]}},z=function(){return function(e){Y(V,e),G().then(function(t){e({type:K,payload:t})}),Q(V,e)}},H=function(){return function(e){Y(V,e),L().then(function(t){var n=t.data;e({type:V.Loaded,payload:n}),Q(V,e)})}},J=function(){return function(e){Y($,e),B().then(function(t){var n=t.data;e({type:$.Loaded,payload:n}),Q($,e)})}},Y=function(e,t){t({type:e.Load})},Q=function(e,t){t({type:e.Loaded})},X=(n(83),function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={text:""},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"changeText",value:function(e){this.setState({text:e}),N.a.setActionValue(e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:"modal__text"},r.a.createElement("p",null,"\u041d\u0435\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u0432\u0430\u0448\u0438\u043c\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430\u043c\u0438"),r.a.createElement("p",null,"\u0414\u043b\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0439 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u043f\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435, \u043f\u043e"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://oauth.vk.com/authorize?client_id=6726221&redirect_uri=https://oauth.vk.com/blank.html&display=page&response_type=token&v=5.85&scope=groups,offline"},"\u044d\u0442\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435"),"."),r.a.createElement("p",null,"\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u043d\u0430\u0448\u0435\u043c\u0443 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044e"),r.a.createElement("p",null,"\u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435 \u043f\u043e\u043a\u0430\u0436\u0435\u0442 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u0441\u043e\u043e\u0431\u0449\u0430\u044e\u0449\u0443\u044e, \u0447\u0442\u043e \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0430\u0434\u0440\u0435\u0441\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438"),r.a.createElement("p",null,"\u041e\u0434\u043d\u0430\u043a\u043e, \u044d\u0442\u043e \u0430\u0431\u0441\u043e\u043b\u044e\u0442\u043d\u043e \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441 \u043d\u0430\u0448\u0438\u043c \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c"),r.a.createElement("p",null,"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0446\u0435\u043b\u0438\u043a\u043e\u043c URL \u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0432 \u043f\u043e\u043b\u0435 \u043d\u0438\u0436\u0435:"),r.a.createElement("input",{type:"text",placeholder:"https://oauth.vk.com/blank.html#access_token=1383bc6d5df7bf74655b531297c71617b2345687ca&expires_in=0&user_id=159204098",value:this.state.text,onChange:function(t){e.changeText(t.target.value)}}),r.a.createElement("p",null,"\u042d\u0442\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439")))}}]),t}(r.a.Component));function Z(){return r.a.createElement("iframe",{title:"video guide",src:"//vk.com/video_ext.php?oid=-171466987&id=456239020&hash=2a4b21d6648495d0&hd=1",width:"426",height:"210",frameBorder:"0",allowFullScreen:!0})}var ee=n(117),te=["\u0412\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430","\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u043b\u0438"],ne=function(e){function t(){var e,n;Object(p.a)(this,t);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(n=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).state={publics:[],redirect:!1},n.renderGroups=function(e){return e.length?e.map(function(e){return r.a.createElement(E,Object.assign({},e,{key:e.id}))}):null},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n,a,r,s,c,i=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.GetUserGroups,a=t.LoadGroups,r=t.LoadCleanTasks,n(),a(),r(),e.next=6,this.loadGroups();case 6:return s=e.sent,e.next=9,this.loadCleanTasks();case 9:(c=e.sent)&&c.length&&(this.timerId=setInterval(Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.updateCleanTasks();case 2:case"end":return e.stop()}},e,this)})),1500)),s=this.addCleanTaskToGroups(s,c),this.setGroups(s);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this.timerId&&clearInterval(this.timerId)}},{key:"setGroups",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,s=e[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){var c=r.value;this.cleanTaskIsFinished(c.cleanData)&&this.showFinishedAlert(c)}}catch(i){n=!0,a=i}finally{try{t||null==s.return||s.return()}finally{if(n)throw a}}this.setState({publics:e})}},{key:"loadCleanTasks",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/getCleanTasks",{params:{user_vk_id:window.user_id,auth_key:window.auth_key}});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadGroups",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/getPublics",{params:{user_vk_id:window.user_id,auth_key:window.auth_key}});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"showModal",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n,a,r,s=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N()({text:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u043e:",content:"input",button:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c!"});case 2:return t=e.sent,e.prev=3,e.next=6,this.convertPublicLinkToId(t);case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.log(e.t0);case 12:return e.next=14,this.addPublicAndGetItsData(n);case 14:return(a=e.sent).dogs="\u0430\u043d\u0430\u043b\u0438\u0437",a.cleanData={isCleaning:!1},a.onClean=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.startCleanPublicById(a.id);case 2:case"end":return e.stop()}},e,this)})),console.log(a),this.setState(function(e){console.log(e);var t=e.publics.concat(a);return console.log(t),{publics:t}}),e.next=22,this.getDogsCount(a.id);case 22:r=e.sent,this.setState(function(e){return s.getPublicById(e.publics,a.id).dogs=r,{publics:e.publics}});case 24:case"end":return e.stop()}},e,this,[[3,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"startCleanPublicById",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var n,a,r,s=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.startCleanTasks([t]);case 2:if(!("error"in(n=e.sent))){e.next=20;break}if(1!==n.error.id){e.next=15;break}return e.next=7,this.getAccessTokenFromUser();case 7:return a=e.sent,e.next=10,this.setAccessToken(a);case 10:return e.next=12,this.onStartClean();case 12:return e.abrupt("return",e.sent);case 15:if(2!==n.error.id){e.next=18;break}return e.next=18,this.showNotEnoughMoneyModal(n.error.value);case 18:e.next=23;break;case 20:r=this.setCleaningStateOnPublicById(t),this.setGroups(r),this.timerId=setInterval(Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.updateCleanTasks();case 2:return console.log(s),e.next=5,s.props.updateBalance();case 5:case"end":return e.stop()}},e,this)})),1500);case 23:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"convertPublicLinkToId",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n="vk.com/",t.includes(n)){e.next=3;break}throw new Error("no vk.com in link");case 3:if(a=t.slice(t.indexOf(n)+n.length),!this.isId(a)){e.next=6;break}return e.abrupt("return",this.getPublicId(a));case 6:return e.next=8,this.resolvePublicName(a);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onStartClean",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n,a,r,s=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getPublicIds(),e.next=3,this.startCleanTasks(t);case 3:if(!("error"in(n=e.sent))){e.next=21;break}if(1!==n.error.id){e.next=16;break}return e.next=8,this.getAccessTokenFromUser();case 8:return a=e.sent,e.next=11,this.setAccessToken(a);case 11:return e.next=13,this.onStartClean();case 13:return e.abrupt("return",e.sent);case 16:if(2!==n.error.id){e.next=19;break}return e.next=19,this.showNotEnoughMoneyModal(n.error.value);case 19:e.next=24;break;case 21:r=this.setCleaningStateOnPublics(),this.setGroups(r),this.timerId=setInterval(Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.updateCleanTasks();case 2:return e.next=4,s.props.updateBalance();case 4:case"end":return e.stop()}},e,this)})),1500);case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setCleaningStateOnPublics",value:function(){return this.state.publics.map(function(e){return e.cleanData={isCleaning:!0,progress:0,status:"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u043f\u0440\u043e\u0441"},e})}},{key:"setCleaningStateOnPublicById",value:function(e){var t=this.state.publics.slice(),n=t.findIndex(function(t){return t.id===e});return t[n].cleanData={isCleaning:!0,progress:0,status:"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u0437\u0430\u043f\u0440\u043e\u0441"},t}},{key:"startCleanTasks",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.post("https://hot-dog.site/api/startCleanTasks",{user_vk_id:window.user_id,auth_key:window.auth_key,public_ids:t});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"cleanTaskIsFinished",value:function(e){return te.includes(e.status)}},{key:"getPublicIds",value:function(){return this.state.publics.map(function(e){return e.id})}},{key:"resolvePublicName",value:function(e){return new Promise(function(t,n){VK.api("utils.resolveScreenName",{screen_name:e,v:"5.85"},function(e){var a=e.response;"group"===a.type&&t(a.object_id),n("not group")})})}},{key:"isId",value:function(e){return Boolean(e.match(/^((club)|(public))\d+$/))}},{key:"getPublicId",value:function(e){return+e.match(/\d+$/)[0]}},{key:"addPublicAndGetItsData",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.post("https://hot-dog.site/api/addPublic",{user_vk_id:window.user_id,auth_key:window.auth_key,vk_id:t});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getDogsCount",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/getDogsCount",{params:{id:t,user_vk_id:window.user_id,auth_key:window.auth_key}});case 2:return e.abrupt("return",e.sent.data.dogs_count);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAccessTokenFromUser",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.document.createElement("div"),c.a.render(r.a.createElement(X,null),t),n=t.firstChild,e.next=5,N()({title:"\u0423\u043f\u0441. \u041c\u044b \u043d\u0435 \u043c\u043e\u0436\u0435\u043c \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0432\u0430\u0448\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430",content:n,buttons:{confirm:{text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c!",value:""}}});case 5:return a=e.sent,e.abrupt("return",this.getAccessTokenFromLink(a));case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setAccessToken",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.patch("https://hot-dog.site/api/setAccessToken",{access_token:t,user_vk_id:window.user_id,auth_key:window.auth_key});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addCleanTaskToGroups",value:function(e,t){var n=this;if(t&&t.length){var a=!0,r=!1,s=void 0;try{for(var c,i=function(){var e=c.value;e.onClean=Object(l.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.startCleanPublicById(e.id);case 2:case"end":return t.stop()}},t,this)}));var a=!0,r=!1,s=void 0;try{for(var i,u=t[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var p=i.value;e.id===p.public_id&&(e.cleanData={isCleaning:!0,progress:p.progress,status:p.status})}}catch(d){r=!0,s=d}finally{try{a||null==u.return||u.return()}finally{if(r)throw s}}e.cleanData||(e.cleanData={isCleaning:!1})},u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0)i()}catch(p){r=!0,s=p}finally{try{a||null==u.return||u.return()}finally{if(r)throw s}}return e}return e.map(function(e){return e.cleanData={isCleaning:!1},e.onClean=Object(l.a)(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.startCleanPublicById(e.id);case 2:case"end":return t.stop()}},t,this)})),e})}},{key:"getCleanTasks",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/getCleanTasks",{params:{user_vk_id:window.user_id,auth_key:window.auth_key}});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateCleanTasks",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n,a,r,s,c,i,u;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCleanTasks();case 2:if((t=e.sent)&&t.length){e.next=34;break}clearInterval(this.timerId),n=!0,a=!1,r=void 0,e.prev=8,s=this.state.publics[Symbol.iterator]();case 10:if(n=(c=s.next()).done){e.next=17;break}return i=c.value,e.next=14,this.refreshPublicById(i.id);case 14:n=!0,e.next=10;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(8),a=!0,r=e.t0;case 23:e.prev=23,e.prev=24,n||null==s.return||s.return();case 26:if(e.prev=26,!a){e.next=29;break}throw r;case 29:return e.finish(26);case 30:return e.finish(23);case 31:return e.next=33,this.showCommentAlert();case 33:return e.abrupt("return");case 34:u=this.addCleanTaskToGroups(this.state.publics,t),this.setGroups(u);case 36:case"end":return e.stop()}},e,this,[[8,19,23,31],[24,,26,30]])}));return function(){return e.apply(this,arguments)}}()},{key:"showFinishedAlert",value:function(e){}},{key:"render",value:function(){var e=this,t=this.state.publics;return r.a.createElement("div",{className:"clean"},r.a.createElement(g,{onCleanClick:function(){return e.onStartClean()}}),r.a.createElement("div",{className:"publics"},t&&this.renderGroups(t)),r.a.createElement(C,{onClick:function(){return e.showModal()}}),r.a.createElement(Z,null),this.state.redirect&&r.a.createElement(ee.a,{to:this.state.redirect,push:!0}))}},{key:"refreshPublicById",value:function(){var e=Object(l.a)(o.a.mark(function e(t){var n,a,r,s=this;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getFreshPublic(t);case 2:(n=e.sent).cleanData={isCleaning:!1},n.onClean=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.startCleanPublicById(n.id);case 2:case"end":return e.stop()}},e,this)})),a=this.state.publics,r=a.findIndex(function(e){return e.id===t}),a[r]=n,this.setGroups(a);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getFreshPublic",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/refreshPublic",{params:{user_vk_id:window.user_id,auth_key:window.auth_key,id:t}});case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAccessTokenFromLink",value:function(e){return e.slice(e.indexOf("#access_token=")+"#access_token=".length,e.indexOf("&expires_in="))}},{key:"getPublicById",value:function(e,t){return e.find(function(e){return e.id===t})}},{key:"showNotEnoughMoneyModal",value:function(){var e=Object(l.a)(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N()({title:"\u0423\u043f\u0441.. \u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u0435\u043d\u0435\u0433",icon:"error",text:"\u0414\u043b\u044f \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432 \u043d\u0443\u0436\u043d\u043e \u0435\u0449\u0435 ".concat(t,"\u0440.\n\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0431\u0430\u043b\u0430\u043d\u0441"),button:{text:"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c"}});case 2:e.sent&&this.setState({redirect:"/add_money"});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"showCommentAlert",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N()({title:"\u0421\u043f\u0430\u0441\u0438\u0431\u043e!",icon:"success",text:"\u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u0442\u0437\u044b\u0432 \u043e \u0441\u0435\u0440\u0432\u0438\u0441\u0435 :)",button:"\u0425\u043e\u0440\u043e\u0448\u043e"});case 2:e.sent&&this.setState({redirect:"/feedback"});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}(a.Component),ae=Object(i.b)(function(e){var t=e.clean;return{groups:t.groups,hotDogsGroups:t.hotDogsGroups,cleanTasks:t.cleanTasks}},function(e){return Object(j.b)({GetUserGroups:z,LoadGroups:H,LoadCleanTasks:J},e)})(ne),re=n(29),se=n(118),ce=(n(106),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("header",{className:"nav"},r.a.createElement("nav",null,r.a.createElement(se.a,{className:"nav__item",to:"/clean"},"\u041e\u0447\u0438\u0441\u0442\u043a\u0430"),r.a.createElement(se.a,{className:"nav__item",to:"/feedback"},"\u041e\u0442\u0437\u044b\u0432\u044b"),r.a.createElement(se.a,{className:"nav__item",to:"/add_money"},"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0431\u0430\u043b\u0430\u043d\u0441")),r.a.createElement("div",null,r.a.createElement("span",{className:"balance"},r.a.createElement("i",{className:"icon-rouble"}),this.props.balance,"\u0440")))}}]),t}(a.Component)),ie=(n(108),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.timerId=window.setInterval(function(){e.props.updateBalance()},1e3)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.timerId)}},{key:"render",value:function(){return r.a.createElement("div",{className:"add-money-page"},r.a.createElement("div",{className:"text"},r.a.createElement("p",null,"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u043b\u0430\u043d\u0441 \u0434\u043b\u044f \u043e\u0447\u0438\u0441\u0442\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u0441\u0442\u0432\u0430:")),r.a.createElement("form",{action:"https://money.yandex.ru/quickpay/confirm.xml",method:"post",target:"_blank"},r.a.createElement("input",{type:"hidden",name:"receiver",value:"410011043655449"}),r.a.createElement("input",{type:"hidden",name:"quickpay-form",value:"shop"}),r.a.createElement("input",{type:"hidden",name:"targets",value:"Hot Dog"}),r.a.createElement("div",{className:"money-input-wrapper"},r.a.createElement("p",null,r.a.createElement("label",{htmlFor:"money-input"},"\u0421\u0443\u043c\u043c\u0430:")),r.a.createElement("input",{type:"text",name:"sum",placeholder:"100 \u0440\u0443\u0431",id:"money-input",className:"money-input",autoComplete:"false"}),r.a.createElement("p",null,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f \u2014 0%")),r.a.createElement("div",{className:"payment-type-wrapper"},r.a.createElement("p",null,"\u0421\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b:"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"paymentType",value:"PC"}),"\u042f\u043d\u0434\u0435\u043a\u0441.\u0414\u0435\u043d\u044c\u0433\u0430\u043c\u0438"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",name:"paymentType",value:"AC"}),"\u0411\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0439")),r.a.createElement("input",{type:"hidden",name:"formcomment",value:"hot dog: \u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0431\u0430\u043b\u0430\u043d\u0441\u0430"}),r.a.createElement("input",{type:"hidden",name:"short-dest",value:"hot dog: \u043f\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0431\u0430\u043b\u0430\u043d\u0441\u0430"}),r.a.createElement("input",{type:"hidden",name:"label",value:"hot-dog: ".concat(window.user_id)}),r.a.createElement("input",{type:"hidden",name:"successURL",value:"https://vk.com/app6731681_-171466987"}),r.a.createElement("button",{type:"submit",className:"submit-button"},"\u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c")))}}]),t}(r.a.Component)),ue=(n(110),function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillMount",value:function(){VK.Widgets.Comments("vk_comments",{limit:10,attach:"*",height:800})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:"vk_comments",className:"vk-comments"}))}}]),t}(r.a.Component));function oe(e){var t=window.location.search.substring(1);window.urlParams=t;for(var n=t.split("&"),a=0;a<n.length;a++){var r=n[a].split("=");if(r[0]===e)return r[1]}}re.init({dsn:Object({NODE_ENV:"production",PUBLIC_URL:"/hot-dog-frontend"}).REACT_APP_SENTRY_DSN});var le=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(h.a)(this,Object(f.a)(t).call(this,e))).state={},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"setBalance",value:function(e){this.setState({balance:e})}},{key:"componentWillMount",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.user_id=oe("viewer_id")||"159204098",window.auth_key=oe("auth_key")||"0819e4635b7c13f5f3de67f1e78bae72",e.next=4,this.updateBalance();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getUserBalance",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.get("https://hot-dog.site/api/getBalance",{params:{user_vk_id:window.user_id,auth_key:window.auth_key}});case 2:return e.abrupt("return",e.sent.data.balance);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(e,t){this.setState({error:e}),re.withScope(function(n){Object.keys(t).forEach(function(e){n.setExtra(e,t[e])}),re.captureException(e)})}},{key:"updateBalance",value:function(){var e=Object(l.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.getUserBalance();case 3:e.t1=e.sent,e.t0.setBalance.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(v.a,{basename:"/hot-dog-frontend"},r.a.createElement(a.Fragment,null,r.a.createElement(ce,{balance:this.state.balance}),r.a.createElement(b.a,null,r.a.createElement(k.a,{exact:!0,path:"/",render:function(){return r.a.createElement(ae,{balance:e.state.balance,updateBalance:e.updateBalance.bind(e)})}}),r.a.createElement(k.a,{path:"/clean",component:ae}),r.a.createElement(k.a,{path:"/add_money",render:function(){return r.a.createElement(ie,{updateBalance:e.updateBalance.bind(e)})}}),r.a.createElement(k.a,{path:"/feedback",component:ue}))))}}]),t}(a.Component);n(112),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pe=n(49),de=Object(j.c)({clean:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return Object(S.a)({},e,{groups:Object(S.a)({},e.groups,{loading:!0})});case K:var n=t.payload;return console.log("PUT IN STATE",n),Object(S.a)({},e,{groups:n});case V.Load:return Object(S.a)({},e,{hotDogsGroups:Object(S.a)({},e.hotDogsGroups,{loading:!0})});case V.Loaded:var a=t.payload;return Object(S.a)({},e,{hotDogsGroups:a});case $.Load:return Object(S.a)({},e,{cleanTasks:Object(S.a)({},e.cleanTasks,{loading:!0})});case $.Loaded:var r=t.payload;return Object(S.a)({},e,{cleanTasks:{loading:!1,data:r,errors:[]}});default:return e}}}),he=[pe.a],fe=window.devToolsExtension,me=[];"function"===typeof fe&&me.push(fe());var ve=j.d.apply(void 0,[j.a.apply(void 0,he)].concat(me)),be=Object(j.e)(de,{},ve);c.a.render(r.a.createElement(i.a,{store:be},r.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},50:function(e,t,n){e.exports=n(114)},60:function(e,t,n){},62:function(e,t,n){},83:function(e,t,n){}},[[50,2,1]]]);
//# sourceMappingURL=main.cfb9254e.chunk.js.map